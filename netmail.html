<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>NetMail</title>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<link rel="stylesheet" href="style.css" />
</head>
<body bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#0000ff">
<ul class="style1">
<li class="style4"><a class="style2" href="email.html">Email</a></li>
<li class="style4"><a class="style2" href="index.html">Home</a></li>
</ul>
<table width=100%>
<td width=20% align=left valign=top>
<br></td>
<td width=60% valign=top>
<center>
<br>
<font size=3><font face="arial"><b>NetMail</b><font size=2><font face="arial"> - Simple program for sending mail from a batch file</font>
</center>
</td>
<td width=20%>
</td>
</table>
<font size=3><font face="arial">
<table width=100%>
<td width=20% align=left valign=top></td>
<td width=60% valign=top bgcolor="#cccccc">

Imports System.Net.Mail <br>
Module Module1 <br>
Sub Main() <br>
Dim strRecipient As String = " " <br>
Dim strSubject As String = " " <br>
Try <br>
Dim a_strArgs() As String <br>
Dim i As Integer <br>
Dim j As Integer <br>
Dim objSmtpClient As New SmtpClient <br>
 <br>
a_strArgs = Split(Command$, " ") <br>
If a_strArgs(0) = "" Then <br>
&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine("Usage: netmail recipient@somewhere.com blah blah blah") <br>
&nbsp;&nbsp;&nbsp;&nbsp;Exit Sub <br>
Else <br>
&nbsp;&nbsp;&nbsp;&nbsp;strRecipient = a_strArgs(0) <br>
&nbsp;&nbsp;&nbsp;&nbsp;strSubject = "" <br>
&nbsp;&nbsp;&nbsp;&nbsp;For i = 1 To UBound(a_strArgs) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSubject = strSubject & a_strArgs(i) & " " <br>
&nbsp;&nbsp;&nbsp;&nbsp;Next <br>
End If <br>
 <br>
objSmtpClient.Host = "myhost" <br>
objSmtpClient.Send("donotreply@somewhere.co.uk",strRecipient, strSubject, "from NetMail") <br>
Console.WriteLine("Message sent to " & strRecipient & " - " & Now()) <br>
Catch ex As Exception <br>
&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(ex.Message) <br>
&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(strRecipient) <br>
&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(strSubject) <br>
End Try <br>
End Sub <br>
End Module <br>

</td>
<td width=20%>
</td>
</table>
</b>
</font>
<script type="text/javascript" src="analytics.js"></script>
</body
</html>

