<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Getting started with Microsoft Excel VBA - Hello World</title>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<link rel="stylesheet" href="style.css" />
</head>
<body>
<ul class="style1">
<li class="style4">
<a class="style2" href="email.html">Email</a>
</li>
<li class="style4">
<a class="style2" href="index.html">Home</a>
</li>
</ul>
<div class="style62"><br/><br/>Getting started with Microsoft Excel VBA - Hello World</div>
<br/><br/>
<div class="style84">
  Open Excel
  <br/>
  Blank Workbook
  <br/>
  File > Options
  <br/>
  Customise the Ribbon
  <br/>
  Main Tab > Developer > OK
  <br/>
  Developer
  <br/>
  Visual Basic
  <br/>
  Insert
  <br/>
  Module
  <pre>
  Sub sbHelloWorld()
    MsgBox "HelloWorld"
  End Sub
  </pre>
  Run > Reset
  <br/>
  File > Save
  <br/>
  Filename: xl_HW
  <br/>
  Save as type: Excel Macro-Enabled Workbook (*.xlsm)
  <br/>
  Save
  <br/>
  Run > Run Sub
  <br/>
  As at 10:16 30th December 2022 Microsoft 365 Excel Version 2211 (Build 15831.20208 Click-to-Run)
  <br/>
  =====
  <br/>
  To add a button which calls the subroutine
  <br/>
  Developer
  <br/>
  Insert
  <br/>
  Button (not Active X)
  <br/>
  -> cross hairs
  <br/>
  locate in the chosen cell
  <br/>
  Assign macro
  <br/>
  sbHelloWorld
  <br/>
  Press the new button 
  <br/>
  Hello World message is displayed
  <br/>
  OK
  <br/>
  <br/>
  =====
  <br/>
  Add a shortcut key sequence to execute the subroutine
  <br/>
  Developer
  <br/>
  Macros
  <br/>
  Macro name 
  <br/>
  sbHelloWorld()
  <br/>
  Macro Options 
  <br/>
  Shortcut key
  <br/>
  "K"
  <br/>
  OK
  <br/>
  Cancel
  <br/>
  Ctrl-Shift-K
  <br/>
  The macro runs
  <br/>
  OK
  <br/>
  <br/>
  =====
  <br/>
  Add a button on the Quick Access Toolbar
  <br/>
  <br/>
  Show the ribbon
  <br/>
  ctrl-F1
  <br/>
  Show the Quick Access Toolbar
  <br/>
  Ribbon Display Options (located in the lower-right below the ribbon)
  <br/>
  Show Quick Access Toolbar
  <br/>
  File
  <br/>
  Options
  <br/>
  Quick Access Toolbar
  <br/>
  Choose commands from:
  <br/>
  Macros
  <br/>
  sbHelloWorld()
  <br/>
  Add
  <br/>
  OK
  <br/>
  Press the QAT button
  <br/>
  The macro runs
  <br/>
  Message displayed - "Hello World"
  <br/>
  OK
  <br/>
  <br/>
  =====
  <br/>
  Simple using the Macro Recorder
<br/>
  Blank Workbook
<br/>
  Developer > Record Macro > OK
<br/>
  Enter "Hello" in A1
<br/>
  Enter "World" in A2
<br/>
  Developer > Stop Recording
<br/>
  Developer > Visual Basic > Expand + Modules
<br/>
  double click Module1
<br/>
  macro generated
<br/>
  <pre>
  Sub Macro1()
    ActiveCell.FormulaR1C1 = "Hello"
    Range("A2").Select
    ActiveCell.FormulaR1C1 = "World"
    Range("A3").Select
  End Sub
  </pre>
  <br/>
  =====
  <br/>
  Turn on option explicit by default for all VBA Code modules
  <br/>
  Developer
  <br/>
  Visual Basic
  <br/>
  Insert 
  <br/>
  Module
  <br/>
  Tools 
  <br/>
  Options
  <br/>
  Require variable declaration
  <br/>
  Tick the box
  <br/>
   OK
  </div>
  <br/>
  <br/>
Call Excel from Python
<pre>
import time
import win32com.client
xl=win32com.client.Dispatch("Excel.Application")
xl.Workbooks.Open(Filename=r"C:\Users\david\Desktop\xl_HW.xlsm",ReadOnly=1)
xl.Application.Run("sbHelloWorld")
xl.Workbooks(1).Close(SaveChanges=0)
xl.Application.Quit()
xl=0
time.sleep(10)
</pre>
Windows 22H2 Build 22621.1194 64 bit - Python 3.11.2 - Microsoft® Excel® for Microsoft 365 MSO (Version 2302 Build 16.0.16130.20186) 64-bit
<br/>
I needed python -m pip install pywin32 for the win32com.client  
<br/>
<br/>
.
