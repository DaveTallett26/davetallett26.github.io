<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-72474361-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-72474361-1');
</script>
<title>VBA Code to log errors to a text file in an Access database</title>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<link rel="stylesheet" href="style.css" />
</head>
<body>
<ul class="style1">
<li class="style4">
<a class="style2" href="email.html">Email</a>
</li>
<li class="style4">
<a class="style2" href="index.html">Home</a>
</li>
</ul>
<div class="style62"><br/><br/>VBA Code to log errors to a text file in an Access database<br/><br/></div>
<font size=3><font face="arial">
<table width=100%><tr>
<td width=25% align=left valign=top></td>
<td width=50% valign=top bgcolor="#cccccc">
<pre>
Private Sub Command32_Click()

 On Error GoTo Command32_Click_Error_Routine

 Dim sFilename As String
 sFilename = "U:\Data\err" & Format(Now(), "yyyymmddHHMMSS") & ".txt"

 MsgBox "Raise Error"
 Err.Raise 2424
' Should never get here
 MsgBox "!!!"

Command32_Click_Exit_Routine:
 Exit Sub

Command32_Click_Error_Routine:
 Open sFilename For Output As #1
 Print #1, "Industrial Computer Contracts (West Midlands) - Error Log - 28th April 2012"
 Print #1, Now()
 Print #1, Me.Name
 Print #1, Err.Number
 Print #1, Err.Description
 Print #1, CurrentDb.Name
 Print #1, "**END**"
 Close #1
 Resume Command32_Click_Exit_Routine

End Sub
</pre>
</td>
<td width=25%>
</td></tr>
</table>
</font>
</font>
</body>
</html>