<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Excel VBA to move emails to subfolder in New Outlook</title>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<link rel="stylesheet" href="style.css" />
</head>
<body>
<ul class="style1">
<li class="style4">
<a class="style2" href="email.html">Email</a>
</li>
<li class="style4">
<a class="style2" href="index.html">Home</a>
</li>
</ul>
<div class="style62"><br/><br/>Excel VBA to move emails to subfolder in New Outlook</div>
<br/><br/>
<table width=100%>
<tr><td width=25% align=left valign=top></td>
<td width=50% valign=top bgcolor="#cccccc">
<font size=3>
<font face="arial">
<pre>
Option Explicit

Sub MoveItems()
 Dim myInbox As Outlook.folder
 Dim mySubfolder As Outlook.folder
 Dim myItems As Outlook.Items
 Dim myItem As Outlook.MailItem
 Dim olkstore As Outlook.Store
 Dim olkRoot As Outlook.folder
    For Each olkstore In Outlook.Session.Stores
        If olkstore.DisplayName = "davidtallett29@gmail.com" Then
            Set olkRoot = olkstore.GetRootFolder
        End If
    Next
 Set myInbox = olkRoot.folders.Item("Inbox")
 Set myItems = myInbox.Items
 Set mySubfolder = myInbox.folders("Newsletters")
' Set myItem = myItems.Find("[SenderName] = 'Royal Mail'")
 Set myItem = myItems.Find("[SenderEmailAddress] = 'agea@noticias.clarin.com'")
 While TypeName(myItem) <> "Nothing"
  myItem.Move mySubfolder
  Set myItem = myItems.FindNext
 Wend
End Sub
</pre>
</font>
</font>
</td>
<td width=25%>
</td>
</tr>
</table>
</body>
</html>

