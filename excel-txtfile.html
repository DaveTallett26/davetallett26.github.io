<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Excel VBA to generate TXT file</title>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<link rel="stylesheet" href="style.css" />
</head>
<body>
<ul class="style1">
<li class="style4">
<a class="style2" href="email.html">Email</a>
</li>
<li class="style4">
<a class="style2" href="index.html">Home</a>
</li>
</ul>
<div class="style62"><br/><br/>Excel VBA to generate TXT file</div>
<br/><br/>
<table width=100%>
<tr><td width=25% align=left valign=top></td>
<td width=50% valign=top bgcolor="#cccccc">
<font size=3>
<font face="arial">
<pre>
Option Explicit

Sub sbMakeTXT()
 ' https://stackoverflow.com/questions/77618965/excel-vba-export-the-data-from-selected-cells-in-to-txt-format
 Dim iRows, iColumns, iRow, iColumn As Long
 Dim sText As String
 Dim sFileName As String
 Dim sTXTLine As String
 Dim sTab As String
 Dim iFileNumber As String
 Dim rSelectedRange As Range
 Set rSelectedRange = Application.Selection
 iColumns = rSelectedRange.Columns.Count
 iRows = rSelectedRange.Rows.Count
 sTab = Chr(9)
 sTXTLine = ""
 sFileName = "C:\Users\david\Desktop\a.txt"
 iFileNumber = FreeFile
 Open sFileName For Output As iFileNumber
 For iRow = 1 To iRows
  For iColumn = 1 To iColumns
   ' Use the .Text in the Cell not .Value to deal with formula results
   sText = Cells(iRow, iColumn).Text
   ' Remove TABs in case they interfere with the file structure
   sText = Replace(sText, sTab, "")
   sTXTLine = sTXTLine & sTab & sText
  Next iColumn
  Print #iFileNumber, sTXTLine
  sTXTLine = ""
 Next iRow
 Close #iFileNumber
End Sub
</pre>
</font>
</font>
</td>
<td width=25%>
</td>
</tr>
</table>
</body>
</html>
